<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏™‡∏∏‡∏î‡πÄ‡∏ó‡πà üî•</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; font-family: 'Kanit', sans-serif; background: linear-gradient(to bottom, #000, #330000); color: #fff; min-height: 100vh; overflow-x: hidden; }
        header { background: #000; padding: 15px; display: flex; justify-content: space-around; align-items: center; position: fixed; top: 0; width: 100%; z-index: 1000; box-shadow: 0 4px 20px rgba(255,0,0,0.7); }
        #shop-logo { height: 60px; width: 60px; border-radius: 50%; border: 3px solid #ff0000; object-fit: cover; }
        #hamburger { font-size: 35px; cursor: pointer; }
        #cart-icon { font-size: 35px; cursor: pointer; position: relative; }
        #cart-badge { position: absolute; top: -10px; right: -10px; background: #ff0000; color: #fff; border-radius: 50%; padding: 5px 10px; font-size: 14px; font-weight: bold; }
        #menu { position: fixed; top: 70px; left: -280px; width: 280px; height: calc(100% - 70px); background: rgba(0,0,0,0.95); transition: left 0.3s; z-index: 999; padding: 20px; box-shadow: 5px 0 15px rgba(255,0,0,0.6); }
        #menu.show { left: 0; }
        #menu ul { list-style: none; padding: 0; margin: 0; }
        #menu li { padding: 20px; border-bottom: 1px solid #ff0000; cursor: pointer; font-size: 18px; transition: 0.3s; }
        #menu li:hover { background: rgba(255,0,0,0.3); }
        .page { display: none; padding: 90px 20px 20px; }
        .page.active { display: block; }
        .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 20px; padding: 0 10px; }
        .product-card { background: rgba(255,255,255,0.1); border-radius: 15px; overflow: hidden; text-align: center; box-shadow: 0 5px 15px rgba(255,0,0,0.5); transition: 0.3s; }
        .product-card:hover { transform: translateY(-10px); box-shadow: 0 10px 25px rgba(255,0,0,0.7); }
        .product-card img { width: 100%; height: 160px; object-fit: cover; }
        .product-card h3 { margin: 10px; font-size: 18px; }
        .product-card p { color: #ff6666; font-weight: bold; }
        .product-card input[type="checkbox"] { transform: scale(1.5); margin: 10px; }
        .product-card input[type="number"] { width: 60px; padding: 8px; border-radius: 5px; border: none; background: #333; color: #fff; }
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); display: none; justify-content: center; align-items: center; z-index: 1001; padding: 10px; box-sizing: border-box; }
        .modal.show { display: flex; }
        .modal-content { background: #111; padding: 30px; border-radius: 15px; width: 90%; max-width: 500px; border: 3px solid #ff0000; text-align: center; }
        button { background: #ff0000; color: #fff; border: none; padding: 12px 25px; margin: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        button:hover { background: #cc0000; }
        .btn-add { background: #ff0000; padding: 15px 30px; font-size: 18px; }
        .btn-full { width: 100%; padding: 15px; font-size: 18px; }
        input, textarea { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: none; background: #333; color: #fff; box-sizing: border-box; }
        #qr-section img { width: 80%; max-width: 250px; margin: 20px 0; border: 3px solid #ff0000; border-radius: 10px; }
        .title-center { text-align:center; font-size:28px; text-shadow: 0 0 10px red; }
        .divider { border-color:#ff0000; }
        .preview-img { width:120px; margin:10px; border-radius:50%; border:3px solid red; }
        .payment-container { text-align:left; max-width:400px; margin:0 auto; padding: 0 10px; }
        .total-text { font-size:20px; }
        .price-highlight { color:#ff0000; }
        .success-title { color:#00ff00; }
        .order-highlight { color:#ff0000; font-size:24px; }
        .btn-copy { background: #ff0000; color: #fff; border: none; padding: 8px 15px; margin-left: 15px; border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 14px; transition: 0.3s; }
        .btn-copy:hover { background: #cc0000; }
        #bank-details p { margin: 15px 0; }
        @media (max-width: 768px) {
            header { padding: 10px; }
            #shop-logo { height: 50px; width: 50px; }
            #hamburger, #cart-icon { font-size: 30px; }
            .products-grid { grid-template-columns: repeat(2, 1fr); gap: 15px; }
            .product-card img { height: 120px; }
            .product-card h3 { font-size: 16px; }
            .product-card input[type="number"] { width: 50px; padding: 6px; }
            .modal-content { padding: 20px; width: 95%; }
            button { padding: 10px 20px; font-size: 16px; }
            .title-center { font-size: 24px; }
            #menu { width: 250px; top: 60px; height: calc(100% - 60px); }
            #menu li { padding: 15px; font-size: 16px; }
            input, textarea { padding: 10px; font-size: 16px; }
            .payment-container { max-width: 100%; padding: 0 15px; }
        }
    </style>
</head>
<body>

<header>
    <div id="hamburger">&#9776;</div>
    <img id="shop-logo" src="https://i.ibb.co/4Z0cMGYR/2-20260209-040714-0001.png " "‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏£‡πâ‡∏≤‡∏ô">
    <div id="cart-icon">üõí<span id="cart-badge">0</span></div>
</header>

<div id="menu">
    <ul>
        <li onclick="goBack()">‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</li>
        <li onclick="showPage('home')">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</li>
        <li onclick="showBankInfo()">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</li>
        <li onclick="enterAdmin()">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô (Admin)</li>
    </ul>
</div>

<div id="home" class="page active">
    <h1 class="title-center">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î üî•</h1>
    <div class="products-grid" id="products-grid"></div>
</div>

<div id="admin-page" class="page">
    <h1 class="title-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≤‡∏ô (Admin)</h1>
    <button class="btn-add" onclick="addProduct()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà</button>
    <div id="admin-products"></div>
    <hr class="divider">
    <h2>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡πâ‡∏≤‡∏ô</h2>
    <p>‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏£‡πâ‡∏≤‡∏ô</p>
    <input type="file" id="shop-logo-input" accept="image/*"><br>
    <img id="shop-logo-preview" src="" alt="Preview" class="preview-img"><br>
    <button onclick="saveShopLogo()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏•‡πÇ‡∏Å‡πâ</button>

    <p>‡∏£‡∏π‡∏õ QR Code ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
    <input type="file" id="qr-input" accept="image/*"><br>
    <img id="qr-preview" src="" alt="Preview" class="preview-img"><br>
    <button onclick="saveQR()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å QR</button>

    <h2>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</h2>
    <p>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</p>
    <input type="text" id="bank-number" placeholder="‡πÄ‡∏ä‡πà‡∏ô 415-047-2070"><br>
    <p>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</p>
    <input type="text" id="bank-owner" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏ò‡∏ô‡∏û‡∏• ‡∏ö‡∏∏‡∏î‡∏≤‡∏£‡∏°‡∏¢‡πå"><br>
    <p>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</p>
    <input type="text" id="bank-name" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÑ‡∏ó‡∏¢‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå"><br>
    <button onclick="saveBank()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏±‡∏ç‡∏ä‡∏µ</button>
</div>

<div id="payment-page" class="page">
    <h1 class="title-center">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h1>
    <div class="payment-container">
        <label><input type="radio" name="payment" value="cod"> ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á (COD)</label><br><br>
        <label><input type="radio" name="payment" value="qr"> ‡∏ä‡∏≥‡∏£‡∏∞‡∏ú‡πà‡∏≤‡∏ô QR Code</label><br><br>
        <div id="qr-section" style="display:none;">
            <p class="total-text">‡∏¢‡∏≠‡∏î‡∏ä‡∏≥‡∏£‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: <span id="payment-total" class="price-highlight">0</span> ‡∏ö‡∏≤‡∏ó</p>
            <img id="shop-qr" src="https://via.placeholder.com/250?text=QR+Code" alt="QR Code">
            <p>‡∏™‡πÅ‡∏Å‡∏ô QR ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏≠‡∏õ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</p>
        </div>
        <button class="btn-full" onclick="completeOrder()">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</button>
    </div>
</div>

<div id="cart-modal" class="modal"><div class="modal-content">
    <h2>‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ üõí</h2>
    <div id="cart-items"></div>
    <p class="total-text">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°: <span id="cart-total">0</span> ‡∏ö‡∏≤‡∏ó</p>
    <button onclick="checkout()">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>
    <button onclick="closeModal('cart-modal')">‡∏õ‡∏¥‡∏î</button>
</div></div>

<div id="checkout-modal" class="modal"><div class="modal-content">
    <h2>‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</h2>
    <input type="text" id="customer-name" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô"><br>
    <input type="text" id="customer-address" placeholder="‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà (‡πÄ‡∏ä‡πà‡∏ô ‡∏ã‡∏≠‡∏¢1 ‡∏ï‡∏≥‡∏ö‡∏•... ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠... ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î...)"><br>
    <input type="text" id="customer-phone" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå"><br>
    <button onclick="goToPayment()">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚ûú</button>
</div></div>

<div id="success-modal" class="modal"><div class="modal-content">
    <h2 class="success-title">‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! üéâ</h2>
    <p>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠: <span id="order-id" class="order-highlight"></span></p>
    <p>‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö üî•</p>
    <button onclick="closeModal('success-modal'); clearCart(); showPage('home')">‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
</div></div>

<div id="bank-modal" class="modal"><div class="modal-content">
    <h2>‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</h2>
    <div id="bank-details" style="text-align:center;">
        <img src="https://upload.wikimedia.org/wikipedia/th/thumb/4/4f/SCB_Logo.svg/800px-SCB_Logo.svg.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÑ‡∏ó‡∏¢‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå" style="width:200px; margin-bottom:20px;">
        <div style="text-align:left; font-size:18px; line-height:2; display:inline-block;">
            <p>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£: <strong id="bank-name-display"></strong></p>
            <p>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: <strong id="bank-owner-display"></strong></p>
            <p>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ: <strong id="bank-number-display"></strong>
                <button class="btn-copy" onclick="copyBankNumber()">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç</button>
            </p>
        </div>
    </div>
    <button class="btn-full" onclick="closeModal('bank-modal')">‡∏õ‡∏¥‡∏î</button>
</div></div>

<script>
    const LINE_TOKEN = '‡πÉ‡∏™‡πà Line Notify Token ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà';

    let cart = JSON.parse(localStorage.getItem('cart') || '{}');
    let products = JSON.parse(localStorage.getItem('products') || '[]');
    let shopInfo = JSON.parse(localStorage.getItem('shopInfo') || '{}');
    let orders = JSON.parse(localStorage.getItem('orders') || '[]');

    // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
    if (products.length === 0) {
        products = [
            {id: 1, name: '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á #1', price: 199, image: 'https://via.placeholder.com/300/ff0000/000000?text=‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤1'},
            {id: 2, name: '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á #2', price: 299, image: 'https://via.placeholder.com/300/ff0000/000000?text=‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤2'},
            {id: 3, name: '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á #3', price: 499, image: 'https://via.placeholder.com/300/ff0000/000000?text=‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤3'}
        ];
        localStorage.setItem('products', JSON.stringify(products));
    }

    // Default ‡∏£‡πâ‡∏≤‡∏ô + ‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏û‡∏µ‡πà AA
    if (!shopInfo.logo) shopInfo.logo = 'https://via.placeholder.com/60/ff0000/000000?text=LOGO';
    if (!shopInfo.qr) shopInfo.qr = 'https://via.placeholder.com/250?text=QR+Code';
    if (!shopInfo.bankName || !shopInfo.bankOwner || !shopInfo.bankNumber) {
        shopInfo.bankName = '‡πÑ‡∏ó‡∏¢‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå';
        shopInfo.bankOwner = '‡∏ò‡∏ô‡∏û‡∏• ‡∏ö‡∏∏‡∏î‡∏≤‡∏£‡∏°‡∏¢‡πå';
        shopInfo.bankNumber = '415-047-2070';
    }
    localStorage.setItem('shopInfo', JSON.stringify(shopInfo));

    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    document.getElementById('shop-logo').src = shopInfo.logo;
    document.getElementById('shop-qr').src = shopInfo.qr;

    function updateCartBadge() {
        const count = Object.values(cart).reduce((sum, q) => sum + q, 0);
        document.getElementById('cart-badge').innerText = count;
    }

    function loadProducts() {
        const grid = document.getElementById('products-grid');
        grid.innerHTML = '';
        products.forEach(p => {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.innerHTML = `
                <img src="${p.image}" alt="${p.name}">
                <h3>${p.name}</h3>
                <p>${p.price} ‡∏ö‡∏≤‡∏ó</p>
                <label><input type="checkbox" onchange="toggleCart(${p.id}, this.checked)" ${cart[p.id] ? 'checked' : ''}> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</label>
                <input type="number" min="1" value="${cart[p.id] || 1}" onchange="updateQuantity(${p.id}, this.value)" ${cart[p.id] ? '' : 'disabled'}>
            `;
            grid.appendChild(card);
        });
    }

    function toggleCart(id, checked) {
        if (checked) cart[id] = cart[id] || 1;
        else delete cart[id];
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartBadge();
        loadProducts();
    }

    function updateQuantity(id, qty) {
        qty = parseInt(qty) || 0;
        if (qty > 0) cart[id] = qty;
        else delete cart[id];
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartBadge();
    }

    function showCart() {
        const itemsDiv = document.getElementById('cart-items');
        itemsDiv.innerHTML = '';
        let total = 0;
        for (let id in cart) {
            const p = products.find(pr => pr.id == id);
            if (p) {
                const sub = p.price * cart[id];
                total += sub;
                itemsDiv.innerHTML += `<p>${p.name} √ó ${cart[id]} = ${sub} ‡∏ö‡∏≤‡∏ó</p>`;
            }
        }
        document.getElementById('cart-total').innerText = total;
        document.getElementById('cart-modal').classList.add('show');
    }

    let currentOrder = {items: {}, total: 0, customer: {}, payment: ''};

    function checkout() {
        closeModal('cart-modal');
        document.getElementById('checkout-modal').classList.add('show');
    }

    function goToPayment() {
        const name = document.getElementById('customer-name').value.trim();
        const address = document.getElementById('customer-address').value.trim();
        const phone = document.getElementById('customer-phone').value.trim();
        if (!name || !address || !phone) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Ñ‡∏£‡∏±‡∏ö!');
        currentOrder.customer = {name, address, phone};
        currentOrder.items = {...cart};
        currentOrder.total = parseInt(document.getElementById('cart-total').innerText) || 0;
        closeModal('checkout-modal');
        showPage('payment-page');
        document.getElementById('payment-total').innerText = currentOrder.total;
        document.querySelectorAll('input[name="payment"]').forEach(r => {
            r.onchange = () => {
                currentOrder.payment = r.value;
                document.getElementById('qr-section').style.display = r.value === 'qr' ? 'block' : 'none';
            };
        });
    }

    function completeOrder() {
        if (!currentOrder.payment) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô');
        const orderId = Date.now();
        const order = {id: orderId, ...currentOrder, date: new Date().toLocaleString('th-TH')};
        orders.push(order);
        localStorage.setItem('orders', JSON.stringify(orders));

        if (LINE_TOKEN && LINE_TOKEN !== '‡πÉ‡∏™‡πà Line Notify Token ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà') {
            let msg = `üî• ‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà!\n‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç: ${orderId}\n‡∏ä‡∏∑‡πà‡∏≠: ${order.customer.name}\n‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà: ${order.customer.address}\n‡πÇ‡∏ó‡∏£: ${order.customer.phone}\n‡∏¢‡∏≠‡∏î: ${order.total} ‡∏ö‡∏≤‡∏ó\n‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞: ${order.payment === 'cod' ? '‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á' : 'QR Code'}\n‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:\n`;
            for (let id in order.items) {
                const p = products.find(pr => pr.id == id);
                msg += `‚Ä¢ ${p.name} √ó ${order.items[id]}\n`;
            }
            fetch('https://notify-api.line.me/api/notify', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                    'Authorization': 'Bearer ' + LINE_TOKEN
                },
                body: 'message=' + encodeURIComponent(msg)
            }).catch(() => {});
        }

        document.getElementById('order-id').innerText = orderId;
        document.getElementById('success-modal').classList.add('show');
    }

    function clearCart() {
        cart = {};
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartBadge();
        loadProducts();
    }

    function showPage(id) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        closeMenu();
    }

    function closeModal(id) {
        document.getElementById(id).classList.remove('show');
    }

    function goBack() {
        history.back();
        closeMenu();
    }

    function showBankInfo() {
        updateBankDisplay();
        document.getElementById('bank-modal').classList.add('show');
        closeMenu();
    }

    function updateBankDisplay() {
        document.getElementById('bank-name-display').innerText = shopInfo.bankName || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤';
        document.getElementById('bank-owner-display').innerText = shopInfo.bankOwner || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤';
        document.getElementById('bank-number-display').innerText = shopInfo.bankNumber || '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤';
    }

    function copyBankNumber() {
        if (shopInfo.bankNumber) {
            navigator.clipboard.writeText(shopInfo.bankNumber)
                .then(() => alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏£‡∏±‡∏ö! üî•'))
                .catch(() => alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏•‡∏≠‡∏á‡∏Å‡∏î‡∏Ñ‡πâ‡∏≤‡∏á‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏≠‡∏á‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö'));
        } else {
            alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ç‡∏ä‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö');
        }
    }

    function closeMenu() {
        document.getElementById('menu').classList.remove('show');
    }

    function enterAdmin() {
        const pass = prompt('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô:');
        if (pass === 'admin123') {
            showPage('admin-page');
            loadAdminProducts();
        } else {
            alert('‡∏£‡∏´‡∏±‡∏™‡∏ú‡∏¥‡∏î‡∏Ñ‡∏£‡∏±‡∏ö!');
        }
        closeMenu();
    }

    function loadAdminProducts() {
        const container = document.getElementById('admin-products');
        container.innerHTML = '';
        products.forEach(p => {
            const div = document.createElement('div');
            div.style = 'background:rgba(255,255,255,0.1); padding:15px; margin:10px 0; border-radius:10px;';
            div.innerHTML = `
                <img src="${p.image}" style="width:100px; border-radius:10px;"><br>
                ‡∏ä‡∏∑‡πà‡∏≠: <input type="text" value="${p.name}" onchange="updateProduct(${p.id}, 'name', this.value)"><br>
                ‡∏£‡∏≤‡∏Ñ‡∏≤: <input type="number" value="${p.price}" onchange="updateProduct(${p.id}, 'price', parseInt(this.value))"><br>
                ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏π‡∏õ: <input type="file" accept="image/*" onchange="uploadProductImage(${p.id}, this.files[0])"><br>
                <button onclick="deleteProduct(${p.id})" style="background:#cc0000;">‡∏•‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</button><hr>
            `;
            container.appendChild(div);
        });
        document.getElementById('shop-logo-preview').src = shopInfo.logo;
        document.getElementById('qr-preview').src = shopInfo.qr;
        document.getElementById('bank-number').value = shopInfo.bankNumber || '';
        document.getElementById('bank-owner').value = shopInfo.bankOwner || '';
        document.getElementById('bank-name').value = shopInfo.bankName || '';
    }

    function updateProduct(id, field, value) {
        const p = products.find(pr => pr.id === id);
        if (p) p[field] = value;
        saveProducts();
        loadProducts();
    }

    function uploadProductImage(id, file) {
        if (!file) return;
        const reader = new FileReader();
        reader.onload = e => {
            const p = products.find(pr => pr.id === id);
            if (p) p.image = e.target.result;
            saveProducts();
            loadProducts();
            loadAdminProducts();
        };
        reader.readAsDataURL(file);
    }

    function addProduct() {
        const newId = products.length ? Math.max(...products.map(p => p.id)) + 1 : 1;
        products.push({id: newId, name: '‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà', price: 100, image: 'https://via.placeholder.com/300/ff0000/000000?text=‡πÉ‡∏´‡∏°‡πà'});
        saveProducts();
        loadProducts();
        loadAdminProducts();
    }

    function deleteProduct(id) {
        if (confirm('‡∏•‡∏ö‡∏à‡∏£‡∏¥‡∏á ‡πÜ ?')) {
            products = products.filter(p => p.id !== id);
            delete cart[id];
            saveProducts();
            localStorage.setItem('cart', JSON.stringify(cart));
            loadProducts();
            loadAdminProducts();
            updateCartBadge();
        }
    }

    function saveProducts() {
        localStorage.setItem('products', JSON.stringify(products));
    }

    function readFilePreview(e, previewId) {
        if (e.target.files[0]) {
            const reader = new FileReader();
            reader.onload = ev => document.getElementById(previewId).src = ev.target.result;
            reader.readAsDataURL(e.target.files[0]);
        }
    }

    document.getElementById('shop-logo-input').onchange = e => readFilePreview(e, 'shop-logo-preview');
    document.getElementById('qr-input').onchange = e => readFilePreview(e, 'qr-preview');

    function saveShopLogo() {
        shopInfo.logo = document.getElementById('shop-logo-preview').src;
        saveShopInfo();
        document.getElementById('shop-logo').src = shopInfo.logo;
    }

    function saveQR() {
        shopInfo.qr = document.getElementById('qr-preview').src;
        saveShopInfo();
        document.getElementById('shop-qr').src = shopInfo.qr;
    }

    function saveBank() {
        shopInfo.bankNumber = document.getElementById('bank-number').value.trim();
        shopInfo.bankOwner = document.getElementById('bank-owner').value.trim();
        shopInfo.bankName = document.getElementById('bank-name').value.trim();
        saveShopInfo();
        updateBankDisplay();
    }

    function saveShopInfo() {
        localStorage.setItem('shopInfo', JSON.stringify(shopInfo));
    }

    // Event listeners
    document.getElementById('hamburger').onclick = () => document.getElementById('menu').classList.toggle('show');
    document.getElementById('cart-icon').onclick = showCart;

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    updateCartBadge();
    loadProducts();
    updateBankDisplay();
</script>
</body>
</html>